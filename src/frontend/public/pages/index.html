<!DOCTYPE html>
<html lang="en">
<head>
    <script defer type="module" src="../components/layout/PageLayout.js"></script>
    <script defer type="module" src="../components/general/UserMessage.js"></script>
    <script defer type="module" src="../components/general/SearchBar.js"></script>
    <script defer type="module" src="../components/general/ProductCard.js"></script>

    <link rel="stylesheet" href="../assets/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
</head>
<body>
<page-layout page-title="Home Page">
    <h1 class="text-center">Artigiani Online</h1>
    <search-bar></search-bar>
    <h2 class="text-center">Scopri i nostri prodotti:</h2>
    <div class="cards-container random__products__cards">
        <section class="cards " id="randomProductContainer"> </section>
    </div>
</page-layout>
</body>
<script type="module">
    import {searchProduct} from "../script/crud/products/search.js";

    document.addEventListener("DOMContentLoaded", async () => {
        const paramsForRandomProducts = new URLSearchParams(new URL("http://localhost:8000/").search);
        paramsForRandomProducts.append("limit", "4")
        paramsForRandomProducts.append("random", "true")
        const randomProducts = await searchProduct(paramsForRandomProducts)
        const randomProductContainer = document.getElementById('randomProductContainer')
        randomProducts.forEach(p => {
            const randomProduct = document.createElement('article');
            randomProduct.className = "random__product card";
            randomProduct.innerHTML = `
                <product-card
                    name = "${p.nome_prodotto}"
                    category = "${p.categoria.categoria}"
                    category = "${p.categoria.categoria}"
                    price = "${p.prezzo}"
                    artisan = "${p.username_artigiano}"
                    stock = "${p.disponibilita}"
                />
            `
            randomProductContainer.appendChild(randomProduct);
        })
    })

</script>
<style>
.random__products__cards {
    margin: 1rem 0;
}
</style>
</html>
